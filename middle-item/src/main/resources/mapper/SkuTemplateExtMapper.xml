<?xml version="1.0" encoding="UTF-8" ?>
<!--
  ~ Copyright (c) 2016. 杭州端点网络科技有限公司.  All rights reserved.
  -->

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="SkuTemplate">

    <!-- for search -->
    <select id="maxId" resultType="long">
        SELECT MAX(id) FROM
        <include refid="tb"/>
    </select>

    <select id="listSince" resultMap="SkuTemplateMap">
        SELECT
        <include refid="cols_all"/>
        FROM
        <include refid="tb"/>
        WHERE  <![CDATA[
          id < #{lastId} AND updated_at > #{since}
        ]]>
        ORDER BY id DESC LIMIT #{limit}
    </select>


    <update id="updateImageByIds" parameterType="map">
        UPDATE
        <include refid="tb"/>
        SET image = #{imageUrl}, updated_at = now()
        WHERE id IN
        <foreach collection="ids" separator="," open="("
                 close=")" item="id">
            #{id}
        </foreach>
    </update>



    <update id="updateTypeByIds" parameterType="map">
        UPDATE
        <include refid="tb"/>
        SET `type` = #{type}, updated_at = now()
        WHERE id IN
        <foreach collection="ids" separator="," open="("
                 close=")" item="id">
            #{id}
        </foreach>
    </update>



</mapper>
