package com.pousheng.middle.consume.index;

import com.google.gson.Gson;
import com.pousheng.middle.consume.index.processor.core.IndexEvent;
import lombok.extern.slf4j.Slf4j;
import org.junit.Test;

/**
 * @author <a href="mailto:d@terminus.io">张成栋</a> at 2019
 * @date 2019-05-16 14:44<br/>
 */
@Slf4j
public class MessageTest {
    @Test
    public void test() {
        String msg = "{\"table\":\"parana_shop_orders\",\"taskName\":\"fix-dump\",\"cols\":[\"id\",\"updated_at\"],\"data\":[[2961814,\"2019-05-15T17:10:28+08:00\"],[2961815,\"2019-05-15T17:10:19+08:00\"],[2961816,\"2019-05-15T17:10:25+08:00\"],[2961817,\"2019-05-15T17:10:18+08:00\"],[2961818,\"2019-05-15T17:10:20+08:00\"],[2961819,\"2019-05-15T17:10:20+08:00\"],[2961820,\"2019-05-15T17:10:23+08:00\"],[2961822,\"2019-05-15T17:17:35+08:00\"],[2961823,\"2019-05-15T17:17:35+08:00\"],[2961824,\"2019-05-15T17:17:34+08:00\"],[2961825,\"2019-05-15T17:15:17+08:00\"],[2961826,\"2019-05-15T17:57:32+08:00\"],[2961827,\"2019-05-15T17:24:39+08:00\"],[2961828,\"2019-05-15T17:15:17+08:00\"],[2961829,\"2019-05-15T17:24:34+08:00\"],[2961830,\"2019-05-15T17:24:34+08:00\"],[2961831,\"2019-05-15T17:24:34+08:00\"],[2961832,\"2019-05-15T17:24:34+08:00\"],[2961833,\"2019-05-15T17:24:32+08:00\"],[2961834,\"2019-05-15T17:24:33+08:00\"],[2961835,\"2019-05-15T17:20:06+08:00\"],[2961836,\"2019-05-15T17:20:06+08:00\"],[2961837,\"2019-05-15T17:20:06+08:00\"],[2961838,\"2019-05-15T17:20:07+08:00\"],[2961839,\"2019-05-15T17:20:08+08:00\"],[2961840,\"2019-05-15T17:20:27+08:00\"],[2961842,\"2019-05-15T17:49:09+08:00\"],[2961843,\"2019-05-15T17:20:34+08:00\"],[2961844,\"2019-05-15T17:20:36+08:00\"],[2961845,\"2019-05-15T17:20:33+08:00\"],[2961846,\"2019-05-15T17:20:42+08:00\"],[2961847,\"2019-05-15T17:20:39+08:00\"],[2961848,\"2019-05-15T17:20:43+08:00\"],[2961849,\"2019-05-15T17:20:42+08:00\"],[2961850,\"2019-05-15T17:20:34+08:00\"],[2961851,\"2019-05-15T17:20:44+08:00\"],[2961852,\"2019-05-15T17:20:42+08:00\"],[2961853,\"2019-05-15T17:20:40+08:00\"],[2961854,\"2019-05-15T17:20:43+08:00\"],[2961855,\"2019-05-15T17:20:43+08:00\"],[2961856,\"2019-05-15T17:20:42+08:00\"],[2961857,\"2019-05-15T17:20:33+08:00\"],[2961858,\"2019-05-15T17:20:43+08:00\"],[2961859,\"2019-05-15T17:20:43+08:00\"],[2961860,\"2019-05-15T17:20:42+08:00\"],[2961861,\"2019-05-15T17:20:43+08:00\"],[2961862,\"2019-05-15T17:20:42+08:00\"],[2961863,\"2019-05-15T17:21:06+08:00\"],[2961864,\"2019-05-15T18:01:08+08:00\"],[2961865,\"2019-05-15T17:49:10+08:00\"],[2961866,\"2019-05-15T18:03:22+08:00\"],[2961867,\"2019-05-15T18:03:22+08:00\"],[2961868,\"2019-05-15T17:21:07+08:00\"],[2961869,\"2019-05-15T17:21:08+08:00\"],[2961870,\"2019-05-15T17:21:08+08:00\"],[2961871,\"2019-05-15T17:21:06+08:00\"],[2961872,\"2019-05-15T18:02:21+08:00\"],[2961873,\"2019-05-15T17:21:09+08:00\"],[2961874,\"2019-05-15T17:21:09+08:00\"],[2961875,\"2019-05-15T17:21:10+08:00\"],[2961876,\"2019-05-15T17:21:10+08:00\"],[2961877,\"2019-05-15T17:21:08+08:00\"],[2961878,\"2019-05-15T17:21:10+08:00\"],[2961879,\"2019-05-15T17:21:10+08:00\"],[2961880,\"2019-05-15T17:21:09+08:00\"],[2961881,\"2019-05-15T17:21:11+08:00\"],[2961882,\"2019-05-15T17:21:10+08:00\"],[2961883,\"2019-05-15T17:21:12+08:00\"],[2961884,\"2019-05-15T17:21:10+08:00\"],[2961885,\"2019-05-15T18:01:09+08:00\"],[2961886,\"2019-05-15T17:21:12+08:00\"],[2961887,\"2019-05-15T17:21:13+08:00\"],[2961888,\"2019-05-15T17:21:11+08:00\"],[2961889,\"2019-05-15T17:21:10+08:00\"],[2961890,\"2019-05-15T17:31:32+08:00\"],[2961891,\"2019-05-15T17:31:32+08:00\"],[2961892,\"2019-05-15T17:31:32+08:00\"],[2961893,\"2019-05-15T17:31:32+08:00\"],[2961894,\"2019-05-15T17:31:32+08:00\"],[2961895,\"2019-05-15T17:31:33+08:00\"],[2961896,\"2019-05-15T17:31:32+08:00\"],[2961897,\"2019-05-15T17:31:32+08:00\"],[2961898,\"2019-05-15T17:31:32+08:00\"],[2961899,\"2019-05-15T17:25:11+08:00\"],[2961900,\"2019-05-15T17:25:11+08:00\"],[2961901,\"2019-05-15T17:25:11+08:00\"],[2961902,\"2019-05-15T17:25:12+08:00\"],[2961903,\"2019-05-15T17:25:13+08:00\"],[2961904,\"2019-05-15T18:02:21+08:00\"],[2961905,\"2019-05-15T17:25:12+08:00\"],[2961906,\"2019-05-15T17:25:13+08:00\"],[2961907,\"2019-05-15T17:25:15+08:00\"],[2961908,\"2019-05-15T17:25:19+08:00\"],[2961909,\"2019-05-15T18:01:08+08:00\"],[2961910,\"2019-05-15T17:25:14+08:00\"],[2961911,\"2019-05-15T17:25:14+08:00\"],[2961912,\"2019-05-15T17:25:15+08:00\"],[2961913,\"2019-05-15T17:25:16+08:00\"],[2961914,\"2019-05-15T17:25:15+08:00\"],[2961915,\"2019-05-15T17:57:32+08:00\"],[2961916,\"2019-05-15T17:25:16+08:00\"],[2961917,\"2019-05-15T17:25:17+08:00\"],[2961918,\"2019-05-15T17:25:17+08:00\"],[2961919,\"2019-05-15T17:25:17+08:00\"],[2961920,\"2019-05-15T17:25:23+08:00\"],[2961921,\"2019-05-15T17:25:23+08:00\"],[2961922,\"2019-05-15T17:25:30+08:00\"],[2961923,\"2019-05-15T17:25:49+08:00\"],[2961924,\"2019-05-15T17:25:49+08:00\"],[2961925,\"2019-05-15T17:25:49+08:00\"],[2961926,\"2019-05-15T17:25:49+08:00\"],[2961927,\"2019-05-15T17:25:50+08:00\"],[2961928,\"2019-05-15T17:25:52+08:00\"],[2961929,\"2019-05-15T17:25:50+08:00\"],[2961930,\"2019-05-15T17:25:50+08:00\"],[2961931,\"2019-05-15T17:25:52+08:00\"],[2961932,\"2019-05-15T17:25:51+08:00\"],[2961933,\"2019-05-15T17:25:53+08:00\"],[2961934,\"2019-05-15T17:25:52+08:00\"],[2961935,\"2019-05-15T17:38:34+08:00\"],[2961936,\"2019-05-15T17:38:34+08:00\"],[2961937,\"2019-05-15T17:38:34+08:00\"],[2961938,\"2019-05-15T17:38:35+08:00\"],[2961939,\"2019-05-15T17:38:43+08:00\"],[2961940,\"2019-05-15T17:38:29+08:00\"],[2961941,\"2019-05-15T17:31:36+08:00\"],[2961942,\"2019-05-15T17:38:30+08:00\"],[2961943,\"2019-05-15T17:38:31+08:00\"],[2961944,\"2019-05-15T17:31:43+08:00\"],[2961945,\"2019-05-15T17:31:42+08:00\"],[2961946,\"2019-05-15T17:33:50+08:00\"],[2961947,\"2019-05-15T17:33:50+08:00\"],[2961948,\"2019-05-15T17:33:50+08:00\"],[2961949,\"2019-05-15T17:33:50+08:00\"],[2961950,\"2019-05-15T17:33:51+08:00\"],[2961951,\"2019-05-15T17:33:51+08:00\"],[2961952,\"2019-05-15T17:33:53+08:00\"],[2961953,\"2019-05-15T17:33:52+08:00\"],[2961954,\"2019-05-15T17:38:34+08:00\"],[2961955,\"2019-05-15T17:38:34+08:00\"],[2961956,\"2019-05-15T17:38:35+08:00\"],[2961957,\"2019-05-15T17:38:34+08:00\"],[2961958,\"2019-05-15T17:38:34+08:00\"],[2961959,\"2019-05-15T17:38:35+08:00\"],[2961960,\"2019-05-15T17:38:34+08:00\"],[2961961,\"2019-05-15T17:35:05+08:00\"],[2961962,\"2019-05-15T17:35:10+08:00\"],[2961963,\"2019-05-15T17:35:10+08:00\"],[2961964,\"2019-05-15T17:35:14+08:00\"],[2961965,\"2019-05-15T17:35:16+08:00\"],[2961966,\"2019-05-15T17:35:16+08:00\"],[2961967,\"2019-05-15T17:35:18+08:00\"],[2961968,\"2019-05-15T17:35:15+08:00\"],[2961969,\"2019-05-15T17:35:16+08:00\"],[2961970,\"2019-05-15T17:35:15+08:00\"],[2961971,\"2019-05-15T17:35:15+08:00\"],[2961972,\"2019-05-15T17:35:21+08:00\"],[2961973,\"2019-05-15T17:35:22+08:00\"],[2961974,\"2019-05-15T17:35:19+08:00\"],[2961975,\"2019-05-15T17:35:21+08:00\"],[2961976,\"2019-05-15T17:35:21+08:00\"],[2961977,\"2019-05-15T17:35:20+08:00\"],[2961978,\"2019-05-15T17:35:20+08:00\"],[2961979,\"2019-05-15T17:35:21+08:00\"],[2961980,\"2019-05-15T17:35:21+08:00\"],[2961981,\"2019-05-15T17:35:21+08:00\"],[2961982,\"2019-05-15T17:35:21+08:00\"],[2961983,\"2019-05-15T17:45:47+08:00\"],[2961984,\"2019-05-15T17:45:49+08:00\"],[2961985,\"2019-05-15T17:45:41+08:00\"],[2961986,\"2019-05-15T17:40:07+08:00\"],[2961987,\"2019-05-15T17:40:08+08:00\"],[2961988,\"2019-05-15T17:40:09+08:00\"],[2961989,\"2019-05-15T17:40:10+08:00\"],[2961990,\"2019-05-15T17:40:10+08:00\"],[2961991,\"2019-05-15T17:40:11+08:00\"],[2961992,\"2019-05-15T17:40:12+08:00\"],[2961993,\"2019-05-15T17:40:53+08:00\"],[2961994,\"2019-05-15T17:40:52+08:00\"],[2961995,\"2019-05-15T17:40:53+08:00\"],[2961996,\"2019-05-15T17:40:54+08:00\"],[2961997,\"2019-05-15T17:40:56+08:00\"],[2961998,\"2019-05-15T17:40:54+08:00\"],[2961999,\"2019-05-15T17:40:54+08:00\"],[2962000,\"2019-05-15T17:40:55+08:00\"],[2962001,\"2019-05-15T17:40:55+08:00\"],[2962002,\"2019-05-15T17:40:55+08:00\"],[2962003,\"2019-05-15T18:00:16+08:00\"],[2962004,\"2019-05-15T17:41:03+08:00\"],[2962005,\"2019-05-15T17:41:00+08:00\"],[2962006,\"2019-05-15T17:41:03+08:00\"],[2962007,\"2019-05-15T17:41:03+08:00\"],[2962008,\"2019-05-15T18:00:17+08:00\"],[2962009,\"2019-05-15T17:41:02+08:00\"],[2962010,\"2019-05-15T17:41:04+08:00\"],[2962011,\"2019-05-15T17:41:04+08:00\"],[2962012,\"2019-05-15T17:45:37+08:00\"],[2962013,\"2019-05-15T17:45:48+08:00\"],[2962014,\"2019-05-15T17:45:41+08:00\"],[2962015,\"2019-05-15T17:45:39+08:00\"],[2962016,\"2019-05-15T17:45:45+08:00\"],[2962017,\"2019-05-15T17:45:45+08:00\"],[2962018,\"2019-05-15T17:45:47+08:00\"],[2962019,\"2019-05-15T17:45:47+08:00\"],[2962020,\"2019-05-15T17:45:47+08:00\"],[2962021,\"2019-05-15T17:45:49+08:00\"],[2962022,\"2019-05-15T17:45:48+08:00\"],[2962023,\"2019-05-15T17:45:09+08:00\"],[2962024,\"2019-05-15T17:45:09+08:00\"],[2962025,\"2019-05-15T17:53:14+08:00\"],[2962026,\"2019-05-15T17:45:14+08:00\"],[2962027,\"2019-05-15T17:45:10+08:00\"],[2962028,\"2019-05-15T17:45:11+08:00\"],[2962029,\"2019-05-15T17:45:11+08:00\"],[2962030,\"2019-05-15T17:45:16+08:00\"],[2962031,\"2019-05-15T17:45:12+08:00\"],[2962032,\"2019-05-15T17:45:22+08:00\"],[2962033,\"2019-05-15T17:45:25+08:00\"],[2962034,\"2019-05-15T17:47:35+08:00\"],[2962035,\"2019-05-15T17:47:37+08:00\"],[2962036,\"2019-05-15T17:47:36+08:00\"],[2962037,\"2019-05-15T17:47:38+08:00\"],[2962038,\"2019-05-15T17:47:39+08:00\"],[2962039,\"2019-05-15T17:47:39+08:00\"],[2962040,\"2019-05-15T17:47:39+08:00\"],[2962041,\"2019-05-15T17:47:41+08:00\"],[2962042,\"2019-05-15T17:47:40+08:00\"],[2962043,\"2019-05-15T17:47:40+08:00\"],[2962044,\"2019-05-15T17:47:41+08:00\"],[2962045,\"2019-05-15T17:47:41+08:00\"],[2962046,\"2019-05-15T17:47:41+08:00\"],[2962047,\"2019-05-15T17:47:42+08:00\"],[2962048,\"2019-05-15T17:59:33+08:00\"],[2962049,\"2019-05-15T17:59:33+08:00\"],[2962050,\"2019-05-15T17:59:34+08:00\"],[2962051,\"2019-05-15T17:59:33+08:00\"],[2962052,\"2019-05-15T17:59:33+08:00\"],[2962053,\"2019-05-15T17:59:33+08:00\"],[2962054,\"2019-05-15T17:50:04+08:00\"],[2962055,\"2019-05-15T17:50:05+08:00\"],[2962056,\"2019-05-15T17:50:06+08:00\"],[2962057,\"2019-05-15T17:50:07+08:00\"],[2962058,\"2019-05-15T17:50:07+08:00\"],[2962059,\"2019-05-15T17:50:10+08:00\"],[2962060,\"2019-05-15T17:59:32+08:00\"],[2962061,\"2019-05-15T17:59:32+08:00\"],[2962062,\"2019-05-15T17:59:31+08:00\"],[2962063,\"2019-05-15T17:50:13+08:00\"],[2962064,\"2019-05-15T17:50:15+08:00\"],[2962065,\"2019-05-15T17:50:18+08:00\"],[2962066,\"2019-05-15T17:50:20+08:00\"],[2962067,\"2019-05-15T17:50:23+08:00\"],[2962068,\"2019-05-15T17:50:26+08:00\"],[2962070,\"2019-05-15T17:50:25+08:00\"],[2962071,\"2019-05-15T17:50:29+08:00\"],[2962072,\"2019-05-15T17:50:28+08:00\"],[2962073,\"2019-05-15T17:50:28+08:00\"],[2962074,\"2019-05-15T17:50:26+08:00\"],[2962075,\"2019-05-15T17:50:28+08:00\"],[2962076,\"2019-05-15T17:50:29+08:00\"],[2962077,\"2019-05-15T17:50:29+08:00\"],[2962078,\"2019-05-15T17:50:30+08:00\"],[2962079,\"2019-05-15T17:50:30+08:00\"],[2962080,\"2019-05-15T17:54:29+08:00\"],[2962081,\"2019-05-15T17:50:32+08:00\"],[2962082,\"2019-05-15T17:50:28+08:00\"],[2962083,\"2019-05-15T17:50:31+08:00\"],[2962084,\"2019-05-15T17:50:33+08:00\"],[2962085,\"2019-05-15T17:50:36+08:00\"],[2962086,\"2019-05-15T17:50:39+08:00\"],[2962087,\"2019-05-15T17:50:41+08:00\"],[2962088,\"2019-05-15T17:50:44+08:00\"],[2962089,\"2019-05-15T17:50:44+08:00\"],[2962090,\"2019-05-15T17:50:44+08:00\"],[2962091,\"2019-05-15T17:50:45+08:00\"],[2962092,\"2019-05-15T17:50:44+08:00\"],[2962093,\"2019-05-15T17:50:45+08:00\"],[2962094,\"2019-05-15T17:50:49+08:00\"],[2962095,\"2019-05-15T17:50:46+08:00\"],[2962096,\"2019-05-15T17:50:46+08:00\"],[2962097,\"2019-05-15T17:50:49+08:00\"],[2962098,\"2019-05-15T17:50:51+08:00\"],[2962099,\"2019-05-15T17:50:53+08:00\"],[2962100,\"2019-05-15T17:50:56+08:00\"],[2962101,\"2019-05-15T17:50:58+08:00\"],[2962102,\"2019-05-15T17:51:00+08:00\"],[2962103,\"2019-05-15T17:51:03+08:00\"],[2962104,\"2019-05-15T17:51:05+08:00\"],[2962105,\"2019-05-15T17:51:09+08:00\"],[2962106,\"2019-05-15T17:59:34+08:00\"],[2962107,\"2019-05-15T17:59:33+08:00\"],[2962108,\"2019-05-15T17:59:33+08:00\"],[2962109,\"2019-05-15T17:59:33+08:00\"],[2962110,\"2019-05-15T17:59:33+08:00\"],[2962111,\"2019-05-15T17:55:22+08:00\"],[2962112,\"2019-05-15T17:55:22+08:00\"],[2962113,\"2019-05-15T17:55:22+08:00\"],[2962114,\"2019-05-15T17:57:59+08:00\"],[2962115,\"2019-05-15T17:55:46+08:00\"],[2962116,\"2019-05-15T17:55:41+08:00\"],[2962117,\"2019-05-15T17:55:42+08:00\"],[2962118,\"2019-05-15T17:55:44+08:00\"],[2962119,\"2019-05-15T17:55:46+08:00\"],[2962120,\"2019-05-15T17:55:45+08:00\"],[2962121,\"2019-05-15T17:55:43+08:00\"],[2962122,\"2019-05-15T17:55:45+08:00\"],[2962123,\"2019-05-15T17:55:44+08:00\"],[2962124,\"2019-05-15T17:55:44+08:00\"],[2962125,\"2019-05-15T17:55:43+08:00\"],[2962126,\"2019-05-15T17:55:45+08:00\"],[2962127,\"2019-05-15T17:55:47+08:00\"],[2962128,\"2019-05-15T17:55:45+08:00\"],[2962129,\"2019-05-15T17:55:47+08:00\"],[2962130,\"2019-05-15T17:55:47+08:00\"],[2962131,\"2019-05-15T17:55:54+08:00\"],[2962132,\"2019-05-15T18:03:46+08:00\"],[2962133,\"2019-05-15T18:00:09+08:00\"],[2962134,\"2019-05-15T18:00:08+08:00\"],[2962135,\"2019-05-15T18:03:46+08:00\"],[2962137,\"2019-05-15T18:03:46+08:00\"],[2962138,\"2019-05-15T18:00:10+08:00\"],[2962139,\"2019-05-15T18:00:13+08:00\"],[2962141,\"2019-05-15T18:00:21+08:00\"],[2962142,\"2019-05-15T18:00:27+08:00\"],[2962143,\"2019-05-15T18:00:11+08:00\"],[2962144,\"2019-05-15T18:00:16+08:00\"],[2962145,\"2019-05-15T18:00:12+08:00\"],[2962146,\"2019-05-15T18:00:19+08:00\"],[2962147,\"2019-05-15T18:00:18+08:00\"],[2962148,\"2019-05-15T18:00:17+08:00\"],[2962149,\"2019-05-15T18:00:18+08:00\"],[2962150,\"2019-05-15T18:00:27+08:00\"],[2962151,\"2019-05-15T18:00:28+08:00\"],[2962152,\"2019-05-15T18:00:28+08:00\"],[2962153,\"2019-05-15T18:00:29+08:00\"],[2962155,\"2019-05-15T18:00:34+08:00\"],[2962157,\"2019-05-15T18:00:37+08:00\"],[2962158,\"2019-05-15T18:00:37+08:00\"],[2962159,\"2019-05-15T18:00:36+08:00\"],[2962160,\"2019-05-15T18:00:36+08:00\"],[2962161,\"2019-05-15T18:00:37+08:00\"],[2962162,\"2019-05-15T18:00:37+08:00\"],[2962163,\"2019-05-15T18:00:37+08:00\"],[2962164,\"2019-05-15T18:00:38+08:00\"],[2962165,\"2019-05-15T18:00:38+08:00\"],[2962166,\"2019-05-15T18:00:38+08:00\"],[2962167,\"2019-05-15T18:00:40+08:00\"],[2962168,\"2019-05-15T18:00:38+08:00\"],[2962169,\"2019-05-15T18:00:39+08:00\"],[2962170,\"2019-05-15T18:00:41+08:00\"],[2962171,\"2019-05-15T18:00:40+08:00\"],[2962172,\"2019-05-15T18:00:40+08:00\"],[2962173,\"2019-05-15T18:00:40+08:00\"],[2962174,\"2019-05-15T18:00:40+08:00\"],[2962176,\"2019-05-15T19:20:15+08:00\"]]}";
        Gson g = new Gson();
        IndexEvent m = g.fromJson(msg, IndexEvent.class);
        log.info(m.getTable());
        log.info("{}", m.getCols());
        log.info("{}", m.getData().get(0));
        log.info("{}", m.getData().get(0).get(0).getClass());
    }
}
