<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >


<mapper namespace="StockBill">
    <resultMap id="StockBillMap" type="StockBill">
        <result column="bill_no" property="bill_no"/>
        <result column="company_id" property="company_id"/>
        <result column="bill_status" property="bill_status"/>
        <result column="bill_type" property="bill_type"/>
        <result column="sequence" property="sequence"/>
        <result column="stock_id" property="stock_id"/>
        <result column="barcode" property="barcode"/>
        <result column="quantity" property="quantity"/>
        <result column="original_bill_no" property="original_bill_no"/>
        <result column="modify_datetime" property="modify_datetime"/>
    </resultMap>

    <sql id="tb">
        pousheng_stock_bills
    </sql>

    <sql id="cols_all">
        bill_no, company_id, bill_status, bill_type, sequence, stock_id, barcode,
        quantity, original_bill_no, modify_datetime
    </sql>
    

    <sql id="vals">
        #{bill_no}, #{company_id}, #{bill_status}, #{bill_type}, #{sequence}, #{stock_id}, #{barcode},
        #{quantity}, #{original_bill_no}, #{modify_datetime}
    </sql>

    <insert id="create" parameterType="StockBill">
        INSERT INTO<include refid="tb"/>
        (<include refid="cols_all"/>)
        VALUES(<include refid="vals"/>)
    </insert>

    <select id="findByBillNo" parameterType="string" resultMap="StockBillMap" >
        SELECT <include refid="cols_all" />
        FROM <include refid="tb" />
        WHERE bill_no = #{bill_no}
    </select>

    <select id="count" parameterType="map" resultType="long">
        SELECT COUNT(1)
        FROM
        <include refid="tb"/>
        <!--        <where>
                    <include refid="criteria"/>
                </where>-->
    </select>

    <select id="paging" parameterType="map" resultMap="StockBillMap">
        SELECT
        <include refid="cols_all"/>
        FROM
        <include refid="tb"/>
        <!--        <where>
                    <include refid="criteria"/>
                </where>
                <include refid="custom_sort"/>
        -->
        LIMIT #{offset}, #{limit}
    </select>

    <update id="update" parameterType="StockBill">
        UPDATE <include refid="tb"/>
        <set>
            <if test="company_id != null">company_id = #{company_id},</if>
            <if test="bill_status != null">bill_status = #{bill_status},</if>
            <if test="bill_type != null">bill_type = #{bill_type},</if>
            <if test="quantity != null">quantity = #{quantity},</if>
            modify_datetime = #{modify_datetime}
        </set>
        WHERE bill_no = #{bill_no}
    </update>

    <delete id="delete" parameterType="long">
        delete from <include refid="tb"/>
        where bill_no = #{bill_no}
    </delete>


</mapper>
