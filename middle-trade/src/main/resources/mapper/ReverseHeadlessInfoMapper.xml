<?xml version="1.0" encoding="UTF-8" ?>
<!--
  ~ Copyright (c) 2016 杭州端点网络科技有限公司, Code generated by terminus code gen
  -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="ReverseHeadlessInfo">
    <resultMap id="ReverseHeadlessInfoMap" type="ReverseHeadlessInfo">
        <id column="id" property="id"/>
        <result column="headless_no" property="headlessNo"/>
        <result column="channel" property="channel"/>
        <result column="shop" property="shop"/>
        <result column="express_no" property="expressNo"/>
        <result column="platform_no" property="platformNo"/>
        <result column="customer" property="customer"/>
        <result column="phone" property="phone"/>
        <result column="status" property="status"/>
        <result column="unique_no" property="uniqueNo"/>
        <result column="reason" property="reason"/>
        <result column="relate_asn" property="relateAsn"/>
        <result column="inventory_profit_no" property="inventoryProfitNo"/>
        <result column="ship_mode" property="shipMode"/>
        <result column="ship_company" property="shipCompany"/>
        <result column="ship_express_no" property="shipExpressNo"/>
        <result column="process_type" property="processType"/>


        <result column="created_at" property="createdAt"/>
        <result column="created_by" property="createdBy"/>
        <result column="updated_at" property="updatedAt"/>
        <result column="updated_by" property="updatedBy"/>
        <result column="closed_at" property="closedAt"/>

        <result column="extra_json" property="extraJson"/>
        
    </resultMap>

    <sql id="tb">
        pousheng_reverse_headless_info
    </sql>

    <sql id="cols_all">
        id, <include refid="cols_exclude_id" />
    </sql>

    <sql id="cols_exclude_id">
        headless_no, channel, shop, express_no, platform_no, customer, phone, status, unique_no, reason, relate_asn, inventory_profit_no, ship_mode, ship_company, ship_express_no, created_at, created_by, updated_at, updated_by, extra_json,process_type,closed_at
    </sql>

    <sql id="vals">
        #{headlessNo}, #{channel}, #{shop}, #{expressNo}, #{platformNo}, #{customer}, #{phone}, #{status}, #{uniqueNo}, #{reason}, #{relateAsn}, #{inventoryProfitNo}, #{shipMode}, #{shipCompany}, #{shipExpressNo}, now(), #{createdBy}, now(), #{updatedBy}, #{extraJson},#{processType},#{closedAt}
    </sql>
    <sql id="headless_vals">
        #{headless.headlessNo}, #{headless.channel}, #{headless.shop}, #{headless.expressNo}, #{headless.platformNo}, #{headless.customer}, #{headless.phone}, #{headless.status}, #{headless.uniqueNo}, #{headless.reason}, #{headless.relateAsn}, #{headless.inventoryProfitNo}, #{headless.shipMode}, #{headless.shipCompany}, #{headless.shipExpressNo}, now(), #{headless.createdBy}, now(), #{headless.updatedBy}, #{headless.extraJson},#{headless.processType},#{headless.closedAt}
    </sql>

    <insert id="create" parameterType="ReverseHeadlessInfo" keyProperty="id" useGeneratedKeys="true">
        INSERT INTO
        <include refid="tb" />
        (<include refid="cols_exclude_id" />)
        VALUES
        (<include refid="vals" />)
    </insert>

    <insert id="batchCreate" parameterType="java.util.List" keyProperty="id" useGeneratedKeys="true">
        INSERT INTO
        <include refid="tb" />
        (<include refid="cols_exclude_id" />)
        VALUES
        <foreach collection="list" item="headless" index="index" separator=",">
            (<include refid="headless_vals" />)
        </foreach>
        ON DUPLICATE KEY UPDATE
        headless_no=VALUES(headless_no),
        channel=VALUES(channel),
        shop=VALUES(shop),
        express_no=VALUES(express_no),
        platform_no=VALUES(platform_no),
        customer=VALUES(customer),
        phone=VALUES(phone),
        status=VALUES(status),
        reason=VALUES(reason),
        relate_asn=VALUES(relate_asn),
        inventory_profit_no=VALUES(inventory_profit_no),
        ship_mode=VALUES(ship_mode),
        ship_company=VALUES(ship_company),
        ship_express_no=VALUES(ship_express_no),
        extra_json=VALUES(extra_json),
        process_type=VALUES(process_type),
        closed_at=VALUES(closed_at),
        updated_at=now()
    </insert>


    <select id="findById" parameterType="long" resultMap="ReverseHeadlessInfoMap" >
        SELECT <include refid="cols_all" />
        FROM <include refid="tb" />
        WHERE id = #{id}
    </select>



    <select id="findReverseHeadlessInfoByUniqueNo" parameterType="string" resultMap="ReverseHeadlessInfoMap" >
        SELECT <include refid="cols_all" />
        FROM <include refid="tb" />
        WHERE unique_no = #{uniqueNo}
    </select>

    <update id="update" parameterType="ReverseHeadlessInfo">
        UPDATE
        <include refid="tb"/>
        <set>
            <if test="headlessNo != null">headless_no = #{headlessNo},</if>
            <if test="channel != null">channel = #{channel},</if>
            <if test="shop != null">shop = #{shop},</if>
            <if test="expressNo != null">express_no = #{expressNo},</if>
            <if test="platformNo != null">platform_no = #{platformNo},</if>
            <if test="customer != null">customer = #{customer},</if>
            <if test="phone != null">phone = #{phone},</if>
            <if test="status != null">status = #{status},</if>
            <if test="uniqueNo != null">unique_no = #{uniqueNo},</if>
            <if test="reason != null">reason = #{reason},</if>
            <if test="relateAsn != null">relate_asn = #{relateAsn},</if>
            <if test="inventoryProfitNo != null">inventory_profit_no = #{inventoryProfitNo},</if>
            <if test="shipMode != null">ship_mode = #{shipMode},</if>
            <if test="shipCompany != null">ship_company = #{shipCompany},</if>
            <if test="shipExpressNo != null">ship_express_no = #{shipExpressNo},</if>
            <if test="createdBy != null">created_by = #{createdBy},</if>
            <if test="updatedBy != null">updated_by = #{updatedBy},</if>
            <if test="extraJson != null">extra_json = #{extraJson},</if>
            <if test="processType != null">process_type = #{processType},</if>
            <if test="closedAt != null">closed_at = #{closedAt},</if>

            updated_at=now()
        </set>
        WHERE id = #{id}
    </update>



    <sql id="criteria">
        <if test="id!=null">AND id=#{id}</if>
        <if test="transferOrderId!=null">AND headless_no=#{transferOrderId}</if>
        <if test="expressNo!=null"> AND express_no=#{expressNo}</if>
        <if test="platformNo!=null">AND platform_no=#{platformNo}</if>
        <if test="customer!=null">AND customer=#{customer}</if>
        <if test="phone!=null"> AND phone=#{phone}</if>
        <if test="unique_no!=null"> AND unique_no=#{uniqueNo}</if>
        <if test="relateAsn!=null"> AND relate_asn=#{relateAsn}</if>
        <if test="status!=null">AND
            status IN
            <foreach collection="status" open="(" separator="," close=")" item="s">
                #{s}
            </foreach>
        </if>
        <if test="startAt != null">AND <![CDATA[created_at >= #{startAt}]]> </if>
        <if test="endAt != null">AND <![CDATA[created_at <= #{endAt}]]> </if>
        <if test="closeStartAt != null">AND <![CDATA[closed_at >= #{closeStartAt}]]> </if>
        <if test="closeEndAt != null">AND <![CDATA[closed_at <= #{closeEndAt}]]> </if>
        <if test="channel !=null">AND channel =#{channel}</if>
        <if test="shop !=null">AND shop =#{shop}</if>
        <if test="inventoryProfitNo !=null">AND inventory_profit_no=#{inventoryProfitNo}></if>
        <if test="shipExpressNo !=null">AND ship_express_no=#{shipExpressNo}></if>
        <if test="phone != null">AND phone = #{phone}</if>
        <if test="processType != null">AND process_type = #{processType}</if>
    </sql>


    <select id="paging" parameterType="map" resultMap="ReverseHeadlessInfoMap">
        select id, <include refid="cols_exclude_id"/>
        from <include refid="tb"/>
        <where>
            <include refid="criteria"/>
        </where>
        order by id desc limit #{offset},#{limit}
    </select>

    <select id="count" parameterType="map" resultType="long">
        select count(1)
        from <include refid="tb"/>
        <where>
            <include refid="criteria"/>
        </where>
    </select>


</mapper>